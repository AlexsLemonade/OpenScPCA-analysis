# Results directory instructions

Files in the results directory should not be directly committed to the repository.

Instead, copy results files to an S3 bucket and add a link to the S3 location in this README file.


# Azimuth compatible fetal kidney reference

To perform label transfer using Azimuth and the fetal kidney atlas, a reference is built via [`scripts/download-and-create-fetal-kidney-ref.R`](../scripts/download-and-create-fetal-kidney-ref.R) using the fetal_full.Rds object download from:
"https://datasets.cellxgene.cziscience.com/40ebb8e4-1a25-4a33-b8ff-02d1156e4e9b.rds"

The output can be found in the S3 bucket name `researcher-008971640512-us-east-2` named `references/ref.Rds` and `references/idx.annoy`.

As part of the `00b_characterize_fetal_kidney_reference_Stewart.Rmd` notebook template, we characterized the fetal kidney reference and generated lists of marker genes for the compartment and cell types composing the reference. 
The tables of marker genes can be found in the S3 bucket name `researcher-008971640512-us-east-2`:
- `references/00a_marker_cell-type_fetal_kidney_Stewart.csv`
- `references/00a_marker_compartment_fetal_kidney_Stewart.csv` 
 

# Clustering and label transfer from fetal references

The S3 bucket name `researcher-008971640512-us-east-2` contains one folder for each of the samples of the Wilms tumor dataset SCPCP000006. 

- `01-Seurat_{sample-id}.Rds` is the output of the [`01_seurat-processing.Rmd`](../notebook_template/01_seurat-processing.Rmd) notebook template.
In brief, the `_processed.rds` `sce object` is converted to `Seurat` and normalized using `SCTransform`.
Dimensionality reduction (`RunPCA` and `RunUMAP`) and clustering (`FindNeighbors` and `FindClusters`) are performed before saving the `Seurat` object. 

- `02a-fetal_full_label-transfer_{sample-id}.Rds` is the output of the [`02a_label-transfer_fetal_full_reference_Cao.Rmd`](../notebook_template/02a_label-transfer_fetal_full_reference_Cao.Rmd) notebook template.
In brief, we used `Azimuth` to transfer labels from the `Azimuth` fetal full reference (Cao et al.) 

- `02b-fetal_kidney_label-transfer_{sample-id}.Rds` is the output of the [`02b_label-transfer_fetal_kidney_reference_Stewart.Rmd`](../notebook_template/02b_label-transfer_fetal_kidney_reference_Stewart.Rmd) notebook template.
In brief, we used `Azimuth` to transfer labels from the fetal kidney reference (Stewart et al.) 


Of note, as `01-Seurat_{sample-id}.Rds` is the input of `02a_label-transfer_fetal_full_reference_Cao.Rmd` and `02a-fetal_full_label-transfer_{sample-id}.Rds` the input of `02b-fetal_kidney_label-transfer_{sample-id}.Rds`, the latest `02b-fetal_kidney_label-transfer_{sample-id}.Rds` contains all metadata generated by the 3 notebook templates. 
